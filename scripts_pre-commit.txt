# Nettoyage configuration
pre-commit clean

# Installation des hooks
pre-commit install


# Linting avec corrections automatiques
pre-commit run ruff --all-files

# Formatage du code (src uniquement)
pre-commit run ruff-format --files @(Get-ChildItem -Recurse src,tests -Filter *.py | ForEach-Object { $_.FullName })

# Détection de code inutilisé (src uniquement)
pre-commit run vulture --files @(Get-ChildItem -Recurse src,tests -Filter *.py | ForEach-Object { $_.FullName })

# Analyse de sécurité (src uniquement)
pre-commit run bandit --files @(Get-ChildItem -Recurse src,tests -Filter *.py | ForEach-Object { $_.FullName })

# Tous les hooks sur tous les fichiers
pre-commit run --files @(Get-ChildItem -Recurse src,tests -Filter *.py | ForEach-Object { $_.FullName })

#  PyTest Coverage
pytest --cov=src --cov-report=term-missing --cov-report=html
start htmlcov/index.html

# Upgrade all venv's packages (Windows)
pip list --outdated --format=json | ConvertFrom-Json | ForEach-Object { pip install --upgrade $_.name }